<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Money Pro</title>
    
    <!-- Aapka Naya Ad Code -->
    <script src='//libtl.com/sdk.js' data-zone='9783879' data-sdk='show_9783879'></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { 
            font-family: 'Hind Siliguri', sans-serif; 
            background-color: #ffffff; 
            color: #1e293b; 
        }
        .dark-bg { background-color: #f8fafc; }
        .card-bg { 
            background-color: #ffffff; 
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        .border-accent { border-color: #ff8c00; }
        .text-accent { color: #ff8c00; }
        .btn, .btn-accent, .btn-outline-accent { 
            transition: all 0.2s ease-in-out; 
            transform: scale(1); 
        }
        .btn:active, .btn-accent:active, .btn-outline-accent:active { 
            transform: scale(0.95); 
        }
        .btn-accent { 
            background-color: #ff8c00; 
            color: #ffffff; 
            font-weight: bold; 
        }
        .btn-accent:hover { 
            background-color: #e67e00; 
        }
        .btn-outline-accent { 
            border: 1px solid #ff8c00; 
            color: #ff8c00; 
        }
        .btn-outline-accent:hover { 
            background-color: #ff8c00; 
            color: #ffffff; 
        }
        .input-field { 
            background-color: #f9fafb; 
            border: 1px solid #e5e7eb; 
            color: #1e293b;
        }
        .input-field::placeholder {
            color: #9ca3af;
        }
        .main-page { display: none; }
        .main-page.active { display: flex; animation: fadeIn 0.5s ease-in-out; }
        .sub-page { display: none; }
        .sub-page.active { display: block; animation: fadeIn 0.3s ease-in-out; }
        .bottom-nav a.active { color: #ff8c00; }
        .notification-dot {
            position: absolute; top: -2px; right: -2px; width: 10px; height: 10px;
            background-color: #ef4444; border-radius: 50%; border: 2px solid #ffffff; display: none;
        }
        .timer { 
            background-color: #ff8c00; 
            color: #ffffff; 
            padding: 2px 6px; 
            border-radius: 12px; 
            font-size: 12px; 
            font-weight: bold;
            margin-left: 5px;
        }
        .pending { 
            background-color: #f59e0b; 
            color: white; 
            padding: 2px 6px; 
            border-radius: 12px; 
            font-size: 12px; 
            font-weight: bold;
            margin-left: 5px;
        }
        .verified-badge {
            display: inline-flex;
            align-items: center;
            background-color: #3b82f6;
            color: white;
            border-radius: 12px;
            padding: 2px 8px;
            font-size: 12px;
            margin-left: 5px;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .code-input-container {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background-color: #f3f4f6;
            border-radius: 8px;
        }
    </style>
</head>
<body class="max-w-md mx-auto">

    <!-- App Loader -->
    <div id="loader" class="hidden fixed inset-0 dark-bg bg-opacity-75 flex items-center justify-center z-50">
        <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-accent"></div>
    </div>

    <!-- Authentication Section -->
    <div id="auth-section" class="min-h-screen p-6 flex-col justify-center main-page">
        <h1 class="text-4xl font-bold text-center mb-2 text-accent">Smart Money Pro</h1>
        <p class="text-center text-gray-600 mb-8">‡¶≤‡¶ó‡¶á‡¶® ‡¶¨‡¶æ ‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®</p>
        <div id="auth-container">
            <div id="login-view">
                <input id="login-email" type="email" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤" class="w-full p-3 rounded-lg input-field mb-4">
                <input id="login-password" type="password" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°" class="w-full p-3 rounded-lg input-field mb-4">
                <button id="login-btn" class="w-full p-3 rounded-lg btn-accent mb-4">‡¶≤‡¶ó‡¶á‡¶®</button>
                <p class="text-center text-gray-600">‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü? <a href="#" id="show-signup" class="font-semibold text-accent">‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™</a></p>
            </div>
            <div id="signup-view" class="hidden">
                 <input id="signup-name" type="text" placeholder="‡¶™‡ßÅ‡¶∞‡ßã ‡¶®‡¶æ‡¶Æ" class="w-full p-3 rounded-lg input-field mb-4">
                <input id="signup-email" type="email" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤" class="w-full p-3 rounded-lg input-field mb-4">
                <input id="signup-password" type="password" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°" class="w-full p-3 rounded-lg input-field mb-4">
                <input id="signup-referral" type="text" placeholder="‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶ï‡ßã‡¶° (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)" class="w-full p-3 rounded-lg input-field mb-4">
                <button id="signup-btn" class="w-full p-3 rounded-lg btn-accent mb-4">‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™</button>
                <p class="text-center text-gray-600">‡¶Ü‡¶ó‡ßá ‡¶•‡ßá‡¶ï‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶õ‡ßá? <a href="#" id="show-login" class="font-semibold text-accent">‡¶≤‡¶ó‡¶á‡¶®</a></p>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container" class="min-h-screen flex-col main-page">
        <header class="flex items-center justify-between p-4 sticky top-0 bg-opacity-80 backdrop-blur-md z-10 dark-bg border-b border-gray-200">
            <h1 class="text-xl font-bold text-slate-800">Smart Money Pro</h1>
            <div class="flex items-center space-x-4">
                <div id="notification-bell" class="relative cursor-pointer">
                    <i data-lucide="bell" class="w-6 h-6 text-slate-800"></i>
                    <div id="notification-dot" class="notification-dot"></div>
                </div>
                <i data-lucide="user" class="w-6 h-6 cursor-pointer text-slate-800" onclick="navigateTo('profile-page')"></i>
            </div>
        </header>

        <main class="flex-grow">
            <!-- Home Page -->
            <div id="home-page" class="p-4 space-y-6 sub-page">
                <div class="card-bg p-4 rounded-lg flex items-center justify-between">
                    <div>
                        <p class="text-gray-600 text-sm">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</p>
                        <p class="text-3xl font-bold text-slate-800">‡ß≥<span id="coin-balance">0</span></p>
                    </div>
                    <button id="home-withdraw-btn" class="bg-orange-500 text-white font-semibold px-6 py-2 rounded-lg">‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞</button>
                </div>
                <section>
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-lg font-semibold text-slate-800">‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡¶∏</h2>
                            <p class="text-sm text-gray-600 mb-4">‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡ßá ‡¶∞‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶ø‡¶®</p>
                        </div>
                        <p class="text-sm text-gray-600">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶∏ ‡¶¨‡¶æ‡¶ï‡¶ø: <span id="ads-left-count">...</span></p>
                    </div>
                    <div class="space-y-3">
                        <!-- Only one claim button as requested -->
                        <div class="bg-orange-500 p-3 rounded-lg flex items-center justify-between text-white">
                            <div class="flex items-center space-x-3"><span class="text-3xl">ü§©</span><div><h3 class="font-bold">‡¶∂‡¶∞‡ßç‡¶ü ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</h3><p class="text-xs font-medium">‡¶∞‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°‡ßá‡¶° ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶∏‡ßç‡¶ü‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤</p></div></div>
                            <button class="bg-white text-orange-500 font-bold px-6 py-2 rounded-lg text-sm btn" onclick="claimReward('interstitial')">‡¶ï‡ßç‡¶≤‡ßá‡¶á‡¶Æ</button>
                        </div>
                        
                        <!-- Video Tutorial Button -->
                        <div class="bg-gradient-to-r from-blue-600 to-indigo-600 p-3 rounded-lg flex items-center justify-between text-white">
                            <div class="flex items-center space-x-3">
                                <span class="text-3xl">‚ñ∂Ô∏è</span>
                                <div>
                                    <h3 class="font-bold">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤</h3>
                                    <p class="text-xs font-medium">‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∂‡¶ø‡¶ñ‡ßÅ‡¶®</p>
                                </div>
                            </div>
                            <button class="bg-white text-blue-600 font-bold px-6 py-2 rounded-lg text-sm btn" onclick="navigateTo('video-tutorials-page')">‡¶ì‡¶Ø‡¶º‡¶æ‡¶ö</button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-600 to-blue-600 p-3 rounded-lg flex items-center justify-between text-white">
                            <div class="flex items-center space-x-3"><span class="text-3xl">üíº</span><div><h3 class="font-bold">‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶ú‡¶¨‡¶∏</h3><p class="text-xs font-medium">‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡ß≥5 ‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p></div></div>
                            <button class="bg-white text-purple-600 font-bold px-6 py-2 rounded-lg text-sm btn" onclick="navigateTo('daily-jobs-page')">‡¶∏‡ßç‡¶ü‡¶æ‡¶∞‡ßç‡¶ü</button>
                        </div>

                        <!-- Pro Jobs Button -->
                        <div class="bg-gradient-to-r from-red-600 to-pink-600 p-3 rounded-lg flex items-center justify-between text-white">
                            <div class="flex items-center space-x-3"><span class="text-3xl">üî•</span><div><h3 class="font-bold">‡¶™‡ßç‡¶∞‡ßã ‡¶ú‡¶¨‡¶∏</h3><p class="text-xs font-medium">‡¶ï‡ßã‡¶° ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡ß≥8 ‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p></div></div>
                            <button class="bg-white text-red-600 font-bold px-6 py-2 rounded-lg text-sm btn" onclick="navigateTo('pro-jobs-page')">‡¶∏‡ßç‡¶ü‡¶æ‡¶∞‡ßç‡¶ü</button>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Video Tutorials Page -->
            <div id="video-tutorials-page" class="p-4 space-y-6 sub-page">
                <div class="flex items-center justify-between mb-4">
                    <button onclick="navigateTo('home-page')" class="flex items-center text-gray-600 hover:text-slate-800">
                        <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                        ‡¶™‡¶ø‡¶õ‡¶®‡ßá
                    </button>
                    <h2 class="text-xl font-bold text-slate-800">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤</h2>
                    <div></div>
                </div>
                
                <div class="card-bg p-4 rounded-lg text-center">
                    <h3 class="text-lg font-semibold mb-2 text-slate-800">‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</h3>
                    <p class="text-gray-600 text-sm mb-4">‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶®‡¶§‡ßÅ‡¶® ‡¶¶‡¶ï‡ßç‡¶∑‡¶§‡¶æ ‡¶∂‡¶ø‡¶ñ‡ßÅ‡¶®!</p>
                </div>

                <div id="video-tutorials-container" class="space-y-3">
                    <!-- Video tutorial buttons will be dynamically generated here -->
                </div>
            </div>

            <!-- Wallet Page -->
            <div id="wallet-page" class="p-4 space-y-6 sub-page">
                <h2 class="text-xl font-bold text-center text-slate-800">‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ì‡¶Ø‡¶º‡¶æ‡¶≤‡ßá‡¶ü</h2>
                <div class="card-bg p-4 rounded-lg">
                    <h3 class="font-semibold mb-3 text-slate-800">‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶® ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</h3>
                    <p class="text-sm text-gray-600 mb-1">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏: <span class="font-bold text-accent">‡ß≥<span id="wallet-coin-balance">0</span></span></p>
                    <p class="text-sm text-gray-600 mb-2">‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®: ‡ß≥<span id="min-withdrawal-info">1000</span></p>
                    <p class="text-sm text-red-500 mb-4 font-semibold" id="withdrawal-requirements">‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß®‡ß¶‡¶ü‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®</p>
                    <input id="withdraw-amount" type="number" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" class="w-full p-3 rounded-lg input-field mb-3">
                    <select id="withdraw-method" class="w-full p-3 rounded-lg input-field mb-3">
                        <option value="">‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                        <option value="Bkash">‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂</option>
                        <option value="Nagad">‡¶®‡¶ó‡¶¶</option>
                        <option value="UPI">‡¶á‡¶â‡¶™‡¶ø‡¶Ü‡¶á</option>
                        <option value="Paytm">‡¶™‡ßá‡¶ü‡¶ø‡¶è‡¶Æ</option>
                    </select>
                    <div id="payment-details-container"></div>
                    <button id="withdraw-btn" class="w-full p-3 rounded-lg btn-accent mt-3">‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü</button>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-3 text-slate-800">‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏</h3>
                    <div id="withdrawal-history-list" class="space-y-3"></div>
                </div>
            </div>

            <!-- Refer Page -->
            <div id="refer-page" class="p-4 space-y-6 sub-page">
                 <h2 class="text-xl font-bold text-center text-slate-800">‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶Ø‡¶º ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
                 <div class="card-bg p-6 rounded-lg text-center">
                     <p class="text-gray-600 mb-2">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶ï‡ßã‡¶°</p>
                     <div class="bg-gray-100 p-3 rounded-lg flex items-center justify-center mb-4">
                         <span id="referral-code" class="text-sm font-medium break-all text-slate-800">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span>
                         <button id="copy-code-btn" class="ml-4 text-gray-600 hover:text-orange-500">
                             <i data-lucide="copy" class="w-5 h-5"></i>
                         </button>
                     </div>
                     <p class="text-sm text-gray-700 mb-2">‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡ß≥30 ‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡¶ñ‡¶® ‡¶§‡¶æ‡¶∞‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá</p>
                     <p class="text-sm text-gray-700">‡¶§‡¶æ‡¶∞‡¶æ ‡¶™‡¶æ‡¶¨‡ßá ‡ß≥10 ‡¶ú‡¶Ø‡¶º‡ßá‡¶®‡¶ø‡¶Ç ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</p>
                 </div>
                 
                 <!-- Removed the "Use Referral Code" section -->
                 
                 <!-- Referral Statistics -->
                 <div class="card-bg p-4 rounded-lg">
                    <h3 class="font-semibold mb-3 text-center text-slate-800">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-gray-100 p-3 rounded-lg text-center">
                            <p class="text-gray-600 text-sm">‡¶Æ‡ßã‡¶ü ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤</p>
                            <p class="text-xl font-bold text-slate-800" id="total-referrals">0</p>
                        </div>
                        <div class="bg-gray-100 p-3 rounded-lg text-center">
                            <p class="text-gray-600 text-sm">‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶Ø‡¶º</p>
                            <p class="text-xl font-bold text-slate-800">‡ß≥<span id="referral-earnings">0</span></p>
                        </div>
                    </div>
                 </div>
            </div>

            <!-- Profile Page -->
            <div id="profile-page" class="p-4 space-y-6 sub-page">
                <h2 class="text-xl font-bold text-center mb-4 text-slate-800">‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</h2>
                <div class="flex flex-col items-center">
                    <img id="profile-photo" src="https://placehold.co/100x100/1e1e1e/ff8c00?text=U" class="rounded-full mb-2">
                    <div class="flex items-center">
                        <h2 id="profile-name" class="text-xl font-bold text-slate-800">‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</h2>
                        <span id="verified-badge" class="verified-badge hidden">
                            <i data-lucide="check" class="w-3 h-3 mr-1"></i> Verified
                        </span>
                    </div>
                    <p id="profile-username" class="text-gray-600">@username</p>
                </div>
                <div class="card-bg p-4 rounded-lg mt-4">
                    <h3 class="font-semibold mb-2 text-slate-800">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡¶•‡ßç‡¶Ø</h3>
                    <div class="flex justify-between mb-1">
                        <span class="text-gray-600">‡¶ú‡¶Ø‡¶º‡ßá‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®:</span>
                        <span id="joined-via" class="text-slate-800">Telegram</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶ï‡ßã‡¶°:</span>
                        <span id="profile-referral-code" class="text-slate-800">ABCD1234</span>
                    </div>
                </div>
                <!-- Added admin panel access button for admin users -->
                <div id="admin-access" class="hidden">
                    <button onclick="navigateTo('admin-panel')" class="w-full p-3 rounded-lg bg-purple-600 text-white font-bold mb-3">Admin Panel</button>
                </div>
                <button id="logout-btn" class="w-full mt-6 p-3 rounded-lg bg-red-600 text-white font-bold">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
            </div>
            
            <!-- Notifications Page -->
            <div id="notifications-page" class="p-4 space-y-4 sub-page">
                <h2 class="text-xl font-bold text-center text-slate-800">‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®</h2>
                <div id="notifications-list" class="space-y-3"></div>
            </div>

            <!-- Daily Jobs Page -->
            <div id="daily-jobs-page" class="p-4 space-y-6 sub-page">
                <div class="flex items-center justify-between mb-4">
                    <button onclick="navigateTo('home-page')" class="flex items-center text-gray-600 hover:text-slate-800">
                        <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                        ‡¶™‡¶ø‡¶õ‡¶®‡ßá
                    </button>
                    <h2 class="text-xl font-bold text-slate-800">‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶ú‡¶¨‡¶∏</h2>
                    <div></div>
                </div>
                
                <div class="card-bg p-4 rounded-lg text-center">
                    <h3 class="text-lg font-semibold mb-2 text-slate-800">‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                    <p class="text-gray-600 text-sm mb-4">‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶ú‡¶¨‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®, 15 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡ß≥5 ‡¶Ü‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!</p>
                    <div class="flex items-center justify-center space-x-4 text-sm">
                        <div class="flex items-center">
                            <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                            <span class="text-slate-800">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≠‡ßá‡¶á‡¶≤‡ßá‡¶¨‡¶≤</span>
                        </div>
                        <div class="flex items-center">
                            <span class="w-3 h-3 bg-red-500 rounded-full mr-2"></span>
                            <span class="text-slate-800">‡¶ï‡ßÅ‡¶≤‡¶°‡¶æ‡¶â‡¶®</span>
                        </div>
                    </div>
                </div>

                <div id="daily-jobs-container" class="space-y-3">
                    <!-- Job buttons will be dynamically generated here -->
                </div>
            </div>

            <!-- Pro Jobs Page -->
            <div id="pro-jobs-page" class="p-4 space-y-6 sub-page">
                <div class="flex items-center justify-between mb-4">
                    <button onclick="navigateTo('home-page')" class="flex items-center text-gray-600 hover:text-slate-800">
                        <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                        ‡¶™‡¶ø‡¶õ‡¶®‡ßá
                    </button>
                    <h2 class="text-xl font-bold text-slate-800">‡¶™‡ßç‡¶∞‡ßã ‡¶ú‡¶¨‡¶∏</h2>
                    <div></div>
                </div>
                
                <div class="card-bg p-4 rounded-lg text-center">
                    <h3 class="text-lg font-semibold mb-2 text-slate-800">‡¶ï‡ßã‡¶° ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶Ø‡¶º ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                    <p class="text-gray-600 text-sm mb-4">‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶ú‡¶¨‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶ï‡ßã‡¶° ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡ß≥8 ‡¶Ü‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!</p>
                    <div class="flex items-center justify-center space-x-4 text-sm">
                        <div class="flex items-center">
                            <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                            <span class="text-slate-800">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≠‡ßá‡¶á‡¶≤‡ßá‡¶¨‡¶≤</span>
                        </div>
                        <div class="flex items-center">
                            <span class="w-3 h-3 bg-red-500 rounded-full mr-2"></span>
                            <span class="text-slate-800">‡¶ï‡ßÅ‡¶≤‡¶°‡¶æ‡¶â‡¶®</span>
                        </div>
                    </div>
                </div>

                <div id="pro-jobs-container" class="space-y-3">
                    <!-- Pro job buttons will be dynamically generated here -->
                </div>
            </div>

            <!-- Admin Panel -->
            <div id="admin-panel" class="p-4 space-y-6 sub-page">
                <div class="flex items-center justify-between mb-4">
                    <button onclick="navigateTo('profile-page')" class="flex items-center text-gray-600 hover:text-slate-800">
                        <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                        ‡¶™‡¶ø‡¶õ‡¶®‡ßá
                    </button>
                    <h2 class="text-xl font-bold text-slate-800">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</h2>
                    <div></div>
                </div>

                <!-- Admin Stats Dashboard -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="card-bg p-4 rounded-lg text-center">
                        <p class="text-gray-600 text-sm">‡¶Æ‡ßã‡¶ü ‡¶á‡¶â‡¶ú‡¶æ‡¶∞</p>
                        <p class="text-2xl font-bold text-slate-800" id="admin-total-users">0</p>
                    </div>
                    <div class="card-bg p-4 rounded-lg text-center">
                        <p class="text-gray-600 text-sm">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü ‡¶ú‡¶¨</p>
                        <p class="text-2xl font-bold text-slate-800" id="admin-jobs-today">0</p>
                    </div>
                    <div class="card-bg p-4 rounded-lg text-center">
                        <p class="text-gray-600 text-sm">‡¶Æ‡ßã‡¶ü ‡¶Ü‡¶Ø‡¶º</p>
                        <p class="text-2xl font-bold text-slate-800" id="admin-total-coins">0</p>
                    </div>
                    <div class="card-bg p-4 rounded-lg text-center">
                        <p class="text-gray-600 text-sm">‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</p>
                        <p class="text-2xl font-bold text-slate-800" id="admin-pending-withdrawals">0</p>
                    </div>
                </div>

                <!-- Admin Tabs -->
                <div class="flex space-x-2 mb-4">
                    <button onclick="showAdminTab('jobs')" class="admin-tab-btn flex-1 p-2 rounded-lg bg-purple-600 text-white font-semibold" id="jobs-tab">‡¶ú‡¶¨ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</button>
                    <button onclick="showAdminTab('users')" class="admin-tab-btn flex-1 p-2 rounded-lg card-bg text-gray-600 font-semibold" id="users-tab">‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</button>
                    <button onclick="showAdminTab('withdrawals')" class="admin-tab-btn flex-1 p-2 rounded-lg card-bg text-gray-600 font-semibold" id="withdrawals-tab">‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</button>
                </div>

                <!-- Job Management Tab -->
                <div id="admin-jobs-tab" class="admin-tab-content">
                    <div class="card-bg p-4 rounded-lg mb-4">
                        <h3 class="font-semibold mb-3 text-slate-800">‡¶ú‡¶¨ ‡¶Ø‡ßã‡¶ó/‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                        <div class="space-y-3">
                            <select id="admin-job-select" class="w-full p-3 rounded-lg input-field">
                                <option value="">‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ú‡¶¨ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                            </select>
                            <input id="admin-job-name" type="text" placeholder="‡¶ú‡¶¨‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ" class="w-full p-3 rounded-lg input-field">
                            <input id="admin-job-link" type="url" placeholder="‡¶ú‡¶¨ ‡¶≤‡¶ø‡¶Ç‡¶ï" class="w-full p-3 rounded-lg input-field">
                            <input id="admin-job-code" type="text" placeholder="‡¶ú‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶°" class="w-full p-3 rounded-lg input-field">
                            <div class="flex space-x-2">
                                <button onclick="saveJobSettings()" class="flex-1 p-3 rounded-lg btn-accent">‡¶ú‡¶¨ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                                <button onclick="resetJobForm()" class="flex-1 p-3 rounded-lg btn-outline-accent">‡¶∞‡¶ø‡¶∏‡ßá‡¶ü</button>
                            </div>
                        </div>
                    </div>

                    <div class="card-bg p-4 rounded-lg">
                        <h3 class="font-semibold mb-3 text-slate-800">‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶ú‡¶¨ ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶∂‡¶®</h3>
                        <div id="admin-recent-jobs" class="space-y-2 max-h-64 overflow-y-auto">
                            <!-- Recent job completions will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- User Management Tab -->
                <div id="admin-users-tab" class="admin-tab-content hidden">
                    <div class="card-bg p-4 rounded-lg mb-4">
                        <h3 class="font-semibold mb-3 text-slate-800">‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö</h3>
                        <div class="flex space-x-2">
                            <input id="admin-user-search" type="text" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶®‡¶æ‡¶Æ ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡ßÅ‡¶®" class="flex-1 p-3 rounded-lg input-field">
                            <button onclick="searchUsers()" class="p-3 rounded-lg btn-accent">‡¶∏‡¶æ‡¶∞‡ßç‡¶ö</button>
                        </div>
                    </div>

                    <div class="card-bg p-4 rounded-lg">
                        <h3 class="font-semibold mb-3 text-slate-800">‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
                        <div id="admin-users-list" class="space-y-2 max-h-64 overflow-y-auto">
                            <!-- Users will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Withdrawals Management Tab -->
                <div id="admin-withdrawals-tab" class="admin-tab-content hidden">
                    <div class="card-bg p-4 rounded-lg">
                        <h3 class="font-semibold mb-3 text-slate-800">‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</h3>
                        <div id="admin-withdrawals-list" class="space-y-3 max-h-64 overflow-y-auto">
                            <!-- Pending withdrawals will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <nav class="bottom-nav sticky bottom-0 grid grid-cols-5 items-center text-center py-2 card-bg border-t border-gray-200">
            <a href="#" class="nav-link" data-page="home-page"><i data-lucide="home" class="mx-auto w-6 h-6"></i><span class="text-xs text-slate-800">‡¶π‡ßã‡¶Æ</span></a>
            <a href="#" class="nav-link" data-page="wallet-page"><i data-lucide="wallet" class="mx-auto w-6 h-6"></i><span class="text-xs text-slate-800">‡¶ì‡¶Ø‡¶º‡¶æ‡¶≤‡ßá‡¶ü</span></a>
            <a href="#" class="nav-link" data-page="refer-page"><i data-lucide="users" class="mx-auto w-6 h-6"></i><span class="text-xs text-slate-800">‡¶∞‡ßá‡¶´‡¶æ‡¶∞</span></a>
            <a href="#" class="nav-link" data-page="daily-jobs-page"><i data-lucide="briefcase" class="mx-auto w-6 h-6"></i><span class="text-xs text-slate-800">‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶ú‡¶¨‡¶∏</span></a>
            <a href="#" class="nav-link" data-page="pro-jobs-page"><i data-lucide="award" class="mx-auto w-6 h-6"></i><span class="text-xs text-slate-800">‡¶™‡ßç‡¶∞‡ßã ‡¶ú‡¶¨‡¶∏</span></a>
        </nav>
    </div>
    
    <div id="custom-alert" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg p-6 w-full max-w-sm text-center">
            <p id="alert-message" class="mb-4 text-slate-800"></p>
            <button id="alert-ok-btn" class="btn-accent px-6 py-2 rounded-lg">‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá</button>
        </div>
    </div>

    <script type="module">
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDBnaXav_M1C45PHs78D7n1QlnR1G9e6SY",
            authDomain: "arningappbot-a7aca.firebaseapp.com",
            projectId: "arningappbot-a7aca",
            storageBucket: "arningappbot-a7aca.firebasestorage.app",
            messagingSenderId: "357948746475",
            appId: "1:357948746475:web:e58919995bb8a066d9ecae"
        };
        
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, updateDoc, collection, addDoc, serverTimestamp, query, where, getDocs, orderBy, limit, increment, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let userData = null;
        let appConfig = {};

        const loader = document.getElementById('loader');
        const coinBalanceEl = document.getElementById('coin-balance');
        const walletCoinBalanceEl = document.getElementById('wallet-coin-balance');
        const profileNameEl = document.getElementById('profile-name');
        const profileEmailEl = document.getElementById('profile-username');
        const profilePhotoEl = document.getElementById('profile-photo');
        const verifiedBadgeEl = document.getElementById('verified-badge');
        const referralCodeEl = document.getElementById('referral-code');
        const minWithdrawalInfoEl = document.getElementById('min-withdrawal-info');
        const withdrawalRequirementsEl = document.getElementById('withdrawal-requirements');
        const withdrawMethodSelect = document.getElementById('withdraw-method');
        const notificationDot = document.getElementById('notification-dot');
        const adsLeftCountEl = document.getElementById('ads-left-count');
        const paymentDetailsContainer = document.getElementById('payment-details-container');
        const totalReferralsEl = document.getElementById('total-referrals');
        const referralEarningsEl = document.getElementById('referral-earnings');
        const joinedViaEl = document.getElementById('joined-via');
        const profileReferralCodeEl = document.getElementById('profile-referral-code');

        let currentJobTracking = null;
        let jobTimers = {};

        // Pro Job Codes (these would typically be stored in Firestore)
        const proJobCodes = {
            projob1: "125xs36",
            projob2: "X34de8",
            projob3: "782zw91",
            projob4: "YT861L",
            projob5: "917cd45"
        };

        window.onload = () => {
            lucide.createIcons();
            setupEventListeners();
            showMainPage('auth-section');
            loader.style.display = 'none';
            onAuthStateChanged(auth, handleAuthStateChange);
        };

        async function handleAuthStateChange(user) {
            if (user) {
                loader.style.display = 'flex';
                currentUser = user;
                await fetchUserData();
                if (userData.isBlocked) {
                    showAlert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡ßç‡¶≤‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
                    await signOut(auth);
                    loader.style.display = 'none';
                    return;
                }
                await fetchAppConfig();
                await checkNewNotifications();
                checkAdminAccess();
                updateUI();
                showMainPage('app-container');
                navigateTo('home-page');
                loader.style.display = 'none';
            } else {
                currentUser = null;
                userData = null;
                showMainPage('auth-section');
            }
        }

        async function fetchUserData() {
            if (!currentUser) return;
            const userRef = doc(db, "users", currentUser.uid);
            try {
                const userSnap = await getDoc(userRef);
                if (userSnap.exists()) {
                    userData = userSnap.data();
                } else {
                    const ownReferralCode = Math.random().toString(36).substring(2, 10).toUpperCase();
                    const defaultUserData = {
                        uid: currentUser.uid, 
                        name: currentUser.email.split('@')[0], 
                        email: currentUser.email,
                        balance: 0, 
                        referralCode: ownReferralCode, 
                        referredBy: null,
                        lastNotificationCheck: new Date(),
                        createdAt: serverTimestamp(),
                        dailyAdCount: 0, 
                        lastAdWatchDate: new Date().toISOString().split('T')[0], 
                        isBlocked: false,
                        totalReferrals: 0,
                        referralEarnings: 0,
                        joinedVia: 'Email',
                        isVerified: false
                    };
                    
                    // Check if there's a referral code in the signup form
                    const refCode = document.getElementById('signup-referral')?.value;
                    if (refCode) {
                        defaultUserData.referredBy = refCode;
                        
                        // Add referral bonus to the referrer
                        const referrerQuery = query(collection(db, "users"), where("referralCode", "==", refCode));
                        const referrerSnapshot = await getDocs(referrerQuery);
                        
                        if (!referrerSnapshot.empty) {
                            const referrerDoc = referrerSnapshot.docs[0];
                            const referrerId = referrerDoc.id;
                            const referrerData = referrerDoc.data();
                            
                            // Update referrer's stats
                            await updateDoc(doc(db, "users", referrerId), {
                                totalReferrals: increment(1),
                                referralEarnings: increment(30),
                                balance: increment(30)
                            });
                            
                            // Add 10 tk bonus to new user
                            defaultUserData.balance = 10;
                        }
                    }
                    
                    await setDoc(userRef, defaultUserData);
                    userData = defaultUserData;
                }
            } catch (error) {
                console.error("Error fetching user data:", error);
                showAlert("‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
            }
        }

        async function fetchAppConfig() {
            const configRef = doc(db, "config", "main");
            try {
                const configSnap = await getDoc(configRef);
                appConfig = configSnap.exists() ? configSnap.data() : { 
                    minWithdrawal: 1000, 
                    requiredReferrals: 20,
                    paymentMethods: ["Bkash", "Nagad", "UPI", "Paytm"], 
                    dailyAdLimit: 10, 
                    referralBonus: 30,
                    signupBonus: 10
                };
            } catch (error) {
                console.error("Error fetching app config:", error);
            }
        }
        
        function updateUI() {
            if (!userData) return;
            const balance = userData.balance || 0;
            coinBalanceEl.textContent = balance;
            walletCoinBalanceEl.textContent = balance;
            profileNameEl.textContent = userData.name || 'No Name';
            profileEmailEl.textContent = userData.email || 'No Email';
            
            // Update profile photo if available from Telegram
            if (userData.photo_url) {
                profilePhotoEl.src = userData.photo_url;
            }
            
            // Show verified badge if user is verified
            if (userData.isVerified) {
                verifiedBadgeEl.classList.remove('hidden');
            }
            
            // Update referral code
            referralCodeEl.textContent = userData.referralCode || '...';
            
            totalReferralsEl.textContent = userData.totalReferrals || 0;
            referralEarningsEl.textContent = userData.referralEarnings || 0;
            joinedViaEl.textContent = userData.joinedVia || 'Email';
            profileReferralCodeEl.textContent = userData.referralCode || '...';
            
            minWithdrawalInfoEl.textContent = `${appConfig.minWithdrawal || 1000}`;
            
            // Update payment methods dropdown
            withdrawMethodSelect.innerHTML = '';
            (appConfig.paymentMethods || []).forEach(method => {
                const option = document.createElement('option');
                option.value = method;
                option.textContent = method;
                withdrawMethodSelect.appendChild(option);
            });
            
            updateDynamicPaymentFields();
            updateAdsLeftCount();
            checkWithdrawalRequirements();
            
            // Setup Pro Jobs
            setupProJobs();
        }

        function checkWithdrawalRequirements() {
            if (userData.totalReferrals < (appConfig.requiredReferrals || 20)) {
                withdrawalRequirementsEl.textContent = `‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ${appConfig.requiredReferrals || 20}‡¶ü‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® (‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá: ${userData.totalReferrals})`;
                document.getElementById('withdraw-btn').disabled = true;
                document.getElementById('withdraw-btn').classList.add('opacity-50', 'cursor-not-allowed');
                document.getElementById('home-withdraw-btn').disabled = true;
                document.getElementById('home-withdraw-btn').classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                withdrawalRequirementsEl.textContent = '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º‡¶§‡¶æ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá';
                document.getElementById('withdraw-btn').disabled = false;
                document.getElementById('withdraw-btn').classList.remove('opacity-50', 'cursor-not-allowed');
                document.getElementById('home-withdraw-btn').disabled = false;
                document.getElementById('home-withdraw-btn').classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        function updateAdsLeftCount() {
            const today = new Date().toISOString().split('T')[0];
            if (userData.lastAdWatchDate !== today) {
                userData.dailyAdCount = 0;
            }
            const adsLeft = Math.max(0, (appConfig.dailyAdLimit || 10) - userData.dailyAdCount);
            adsLeftCountEl.textContent = adsLeft;
        }

        function updateDynamicPaymentFields() {
            const selectedMethod = withdrawMethodSelect.value.toLowerCase();
            let placeholder = "‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®";
            if (selectedMethod.includes('bkash')) placeholder = "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®";
            if (selectedMethod.includes('nagad')) placeholder = "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶ó‡¶¶ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®";
            if (selectedMethod.includes('upi')) placeholder = "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ UPI ID ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®";
            if (selectedMethod.includes('paytm')) placeholder = "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ Paytm ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®";
            paymentDetailsContainer.innerHTML = `<input id="payment-detail-input" type="text" placeholder="${placeholder}" class="w-full p-3 rounded-lg input-field">`;
        }

        function showMainPage(pageId) {
            document.querySelectorAll('.main-page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
        }

        function navigateTo(pageId) {
            document.querySelectorAll('.sub-page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active', 'text-accent');
                if (link.dataset.page === pageId) link.classList.add('active', 'text-accent');
            });
            
            if (pageId === 'wallet-page') {
                loadWithdrawalHistory();
                checkWithdrawalRequirements();
            } else if (pageId === 'refer-page') {
                loadReferralStats();
            } else if (pageId === 'daily-jobs-page') {
                updateJobButtonStates();
            } else if (pageId === 'pro-jobs-page') {
                updateProJobButtonStates();
            } else if (pageId === 'admin-panel') {
                loadAdminDashboard();
            } else if (pageId === 'video-tutorials-page') {
                loadVideoTutorials();
            }
        }
        window.navigateTo = navigateTo;

        function setupEventListeners() {
            document.getElementById('show-signup').addEventListener('click', (e) => { e.preventDefault(); document.getElementById('login-view').classList.add('hidden'); document.getElementById('signup-view').classList.remove('hidden'); });
            document.getElementById('show-login').addEventListener('click', (e) => { e.preventDefault(); document.getElementById('signup-view').classList.add('hidden'); document.getElementById('login-view').classList.remove('hidden'); });
            document.getElementById('signup-btn').addEventListener('click', handleSignup);
            document.getElementById('login-btn').addEventListener('click', handleLogin);
            document.getElementById('logout-btn').addEventListener('click', handleLogout);
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const pageId = link.dataset.page;
                    navigateTo(pageId);
                });
            });
            document.getElementById('notification-bell').addEventListener('click', () => { navigateTo('notifications-page'); loadNotifications(); });
            document.getElementById('copy-code-btn').addEventListener('click', copyReferralCode);
            // Removed the useReferralBtn event listener
            document.getElementById('withdraw-btn').addEventListener('click', handleWithdrawal);
            document.getElementById('home-withdraw-btn').addEventListener('click', () => navigateTo('wallet-page'));
            withdrawMethodSelect.addEventListener('change', updateDynamicPaymentFields);
            setupDailyJobs();
        }

        async function handleSignup() {
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const referralCode = document.getElementById('signup-referral').value;
            
            if (!name || !email || !password) return showAlert("‡¶∏‡¶¨ ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
            loader.style.display = 'flex';
            try {
                await createUserWithEmailAndPassword(auth, email, password);
                
                // If referral code was provided, update the user's document
                if (referralCode) {
                    const userRef = doc(db, "users", auth.currentUser.uid);
                    await updateDoc(userRef, {
                        referredBy: referralCode
                    });
                    
                    // Add referral bonus to the referrer
                    const referrerQuery = query(collection(db, "users"), where("referralCode", "==", referralCode));
                    const referrerSnapshot = await getDocs(referrerQuery);
                    
                    if (!referrerSnapshot.empty) {
                        const referrerDoc = referrerSnapshot.docs[0];
                        const referrerId = referrerDoc.id;
                        
                        // Update referrer's stats
                        await updateDoc(doc(db, "users", referrerId), {
                            totalReferrals: increment(1),
                            referralEarnings: increment(30),
                            balance: increment(30)
                        });
                        
                        // Add 10 tk bonus to new user
                        await updateDoc(userRef, {
                            balance: 10
                        });
                    }
                }
            } catch (error) {
                showAlert(error.message);
                loader.style.display = 'none';
            }
        }

        async function handleLogin() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            if (!email || !password) return showAlert("‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®‡•§");
            loader.style.display = 'flex';
            try {
                await signInWithEmailAndPassword(auth, email, password);
            } catch (error) {
                showAlert(error.message);
                loader.style.display = 'none';
            }
        }

        async function handleLogout() { await signOut(auth); }
        
        async function checkNewNotifications() {
            const lastCheck = userData.lastNotificationCheck;
            if (!lastCheck || typeof lastCheck.seconds === 'undefined') {
                console.log("lastNotificationCheck is not a valid timestamp yet. Skipping check.");
                return;
            }
            const q = query(collection(db, "notifications"), where("createdAt", ">", lastCheck), limit(1));
            const querySnapshot = await getDocs(q);
            notificationDot.style.display = querySnapshot.empty ? 'none' : 'block';
        }

        async function loadNotifications() {
            const listEl = document.getElementById('notifications-list');
            listEl.innerHTML = '<p class="text-gray-600">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>';
            notificationDot.style.display = 'none';
            const q = query(collection(db, "notifications"), orderBy("createdAt", "desc"));
            try {
                const querySnapshot = await getDocs(q);
                if (querySnapshot.empty) {
                    listEl.innerHTML = '<p class="text-gray-600 text-center">‡¶ï‡ßã‡¶® ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶®‡ßá‡¶á</p>';
                    return;
                }
                listEl.innerHTML = '';
                querySnapshot.forEach(doc => {
                    const msg = doc.data();
                    const date = msg.createdAt ? msg.createdAt.toDate().toLocaleDateString() : 'N/A';
                    listEl.innerHTML += `<div class="card-bg p-4 rounded-lg"><div class="flex justify-between items-center mb-1"><h3 class="font-bold text-slate-800">${msg.title}</h3><p class="text-xs text-gray-600">${date}</p></div><p class="text-sm text-gray-600">${msg.message}</p></div>`;
                });
                await updateDoc(doc(db, "users", currentUser.uid), { lastNotificationCheck: serverTimestamp() });
            } catch (error) {
                console.error("Error loading notifications:", error);
                listEl.innerHTML = '<p class="text-red-400">‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</p>';
            }
        }

        async function loadWithdrawalHistory() {
            const historyList = document.getElementById('withdrawal-history-list');
            historyList.innerHTML = '<p class="text-gray-600">‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>';
            const q = query(collection(db, "withdrawals"), where("userId", "==", currentUser.uid));
            try {
                const querySnapshot = await getDocs(q);
                if (querySnapshot.empty) {
                    historyList.innerHTML = '<p class="text-gray-600">‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶® ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶ï‡¶∞‡ßá‡¶®‡¶®‡¶ø</p>';
                    return;
                }
                const withdrawals = [];
                querySnapshot.forEach(doc => withdrawals.push(doc.data()));
                withdrawals.sort((a, b) => (b.requestedAt?.seconds || 0) - (a.requestedAt?.seconds || 0));
                historyList.innerHTML = '';
                withdrawals.forEach(request => {
                    const status = request.status;
                    let statusColor = 'text-yellow-500';
                    if (status === 'approved') statusColor = 'text-green-500';
                    else if (status === 'rejected') statusColor = 'text-red-500';
                    const date = request.requestedAt ? request.requestedAt.toDate().toLocaleDateString() : 'N/A';
                    historyList.innerHTML += `<div class="card-bg p-3 rounded-lg flex items-center justify-between"><div><p class="font-semibold text-slate-800">${request.amount} ‡¶ü‡¶æ‡¶ï‡¶æ - ${request.method}</p><p class="text-xs text-gray-600">${date}</p></div><span class="${statusColor} text-sm">${status}</span></div>`;
                });
            } catch (error) {
                console.error("Error fetching withdrawal history: ", error);
                historyList.innerHTML = '<p class="text-red-400">‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</p>';
            }
        }
        
        async function loadReferralStats() {
            try {
                const q = query(collection(db, "users"), where("referredBy", "==", userData.referralCode));
                const querySnapshot = await getDocs(q);
                totalReferralsEl.textContent = querySnapshot.size;
                referralEarningsEl.textContent = userData.referralEarnings || 0;
                
                // Removed the code that shows/hides the use-referral-section
            } catch (error) {
                console.error("Error loading referral stats:", error);
            }
        }

        function copyReferralCode() {
            const referralCode = userData.referralCode;
            
            navigator.clipboard.writeText(referralCode)
                .then(() => {
                    showToast("‡¶ï‡ßã‡¶° ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", "success");
                })
                .catch((error) => {
                    // Fallback method for older browsers
                    const textArea = document.createElement('textarea');
                    textArea.value = referralCode;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    showToast("‡¶ï‡ßã‡¶° ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", "success");
                });
        }

        // Removed the useReferralCode function

        async function handleWithdrawal() {
            const amount = parseInt(document.getElementById('withdraw-amount').value);
            const method = document.getElementById('withdraw-method').value;
            const paymentDetail = document.getElementById('payment-detail-input').value;
            
            if (!amount || amount < appConfig.minWithdrawal) {
                showAlert(`‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡ß≥${appConfig.minWithdrawal}`);
                return;
            }
            
            if (amount > userData.balance) {
                showAlert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏‡ßá ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶®‡ßá‡¶á");
                return;
            }
            
            if (!method) {
                showAlert("‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®");
                return;
            }
            
            if (!paymentDetail) {
                showAlert("‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶¶‡¶ø‡¶®");
                return;
            }
            
            if (userData.totalReferrals < (appConfig.requiredReferrals || 20)) {
                showAlert(`‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ${appConfig.requiredReferrals || 20}‡¶ü‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® (‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá: ${userData.totalReferrals})`);
                return;
            }
            
            try {
                const withdrawalData = {
                    userId: currentUser.uid,
                    userName: userData.name,
                    amount: amount,
                    method: method,
                    paymentDetails: paymentDetail,
                    status: "pending",
                    requestedAt: serverTimestamp()
                };
                
                await addDoc(collection(db, "withdrawals"), withdrawalData);
                
                await updateDoc(doc(db, "users", currentUser.uid), {
                    balance: increment(-amount)
                });
                
                userData.balance -= amount;
                updateUI();
                
                showAlert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡ß®‡ß™-‡ß™‡ßÆ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡¶∏ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá‡•§");
                
                document.getElementById('withdraw-amount').value = '';
                withdrawMethodSelect.value = '';
                paymentDetailsContainer.innerHTML = '';
            } catch (error) {
                console.error("Error processing withdrawal:", error);
                showAlert("‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
            }
        }

        async function updateBalance(amount) {
            try {
                await updateDoc(doc(db, "users", currentUser.uid), {
                    balance: increment(amount)
                });
                userData.balance += amount;
                coinBalanceEl.textContent = userData.balance;
                walletCoinBalanceEl.textContent = userData.balance;
            } catch (error) {
                console.error("Error updating balance:", error);
            }
        }

        function showAlert(message) {
            const alert = document.getElementById('custom-alert');
            const messageEl = document.getElementById('alert-message');
            messageEl.textContent = message;
            alert.classList.remove('hidden');
            document.getElementById('alert-ok-btn').onclick = () => alert.classList.add('hidden');
        }
        window.showAlert = showAlert;

        // Function to load video tutorials
        async function loadVideoTutorials() {
            const container = document.getElementById('video-tutorials-container');
            container.innerHTML = '<p class="text-gray-600 text-center">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>';
            
            try {
                // Fetch tutorial links from Firestore
                const tutorialRef = doc(db, 'config', 'video_tutorial_links');
                const tutorialDoc = await getDoc(tutorialRef);
                
                let tutorialLinks = {};
                if (tutorialDoc.exists()) {
                    tutorialLinks = tutorialDoc.data();
                } else {
                    // Default links if none are configured
                    tutorialLinks = {
                        tutorial1: { title: "‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡ßß", link: "https://example.com/tutorial1" },
                        tutorial2: { title: "‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡ß®", link: "https://example.com/tutorial2" },
                        tutorial3: { title: "‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡ß©", link: "https://example.com/tutorial3" },
                        tutorial4: { title: "‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡ß™", link: "https://example.com/tutorial4" },
                        tutorial5: { title: "‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡ß´", link: "https://example.com/tutorial5" }
                    };
                }
                
                // Clear container
                container.innerHTML = '';
                
                // Create buttons for each tutorial
                for (let i = 1; i <= 5; i++) {
                    const tutorial = tutorialLinks[`tutorial${i}`] || { title: `‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ${i}`, link: '#' };
                    
                    const button = document.createElement('button');
                    button.className = 'w-full p-4 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-600 text-white text-left';
                    button.innerHTML = `
                        <div class="flex items-center justify-between">
                            <span class="font-semibold">${tutorial.title}</span>
                            <i data-lucide="play" class="w-5 h-5"></i>
                        </div>
                    `;
                    
                    button.addEventListener('click', () => {
                        window.open(tutorial.link, '_blank');
                    });
                    
                    container.appendChild(button);
                }
                
                // Refresh icons
                lucide.createIcons();
            } catch (error) {
                console.error("Error loading video tutorials:", error);
                container.innerHTML = '<p class="text-red-400 text-center">‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</p>';
            }
        }

        async function setupDailyJobs() {
            const jobsContainer = document.getElementById('daily-jobs-container');
            if (!jobsContainer) return;

            let jobLinks = {};
            try {
                const configRef = doc(db, 'config', 'daily_job_links');
                const configDoc = await getDoc(configRef);
                if (configDoc.exists()) {
                    jobLinks = configDoc.data();
                }
            } catch (error) {
                console.log("Error fetching job links:", error);
            }

            jobsContainer.innerHTML = '';
            
            for (let i = 1; i <= 20; i++) {
                const jobLink = jobLinks[`job${i}`] || '#';
                const jobDiv = document.createElement('div');
                jobDiv.className = 'card-bg p-4 rounded-lg flex items-center justify-between';
                jobDiv.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">${i}</div>
                        <div>
                            <h3 class="text-slate-800 font-medium">Watch and get reward</h3>
                            <p class="text-gray-600 text-sm">‡ß≥5 ‡¶Ü‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                        </div>
                    </div>
                    <button id="job-btn-${i}" onclick="handleJobClick(${i}, '${jobLink}')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®
                    </button>
                `;
                jobDiv.querySelector('button').setAttribute('data-job-link', jobLink);
                jobsContainer.appendChild(jobDiv);
            }
            
            updateJobButtonStates();
        }

        async function updateJobButtonStates() {
            if (!currentUser) return;
            
            const completedJobsRef = collection(db, 'daily_jobs_completed');
            const q = query(completedJobsRef, where('userId', '==', currentUser.uid));
            
            try {
                const completedJobs = await getDocs(q);
                const jobCompletions = {};
                
                completedJobs.forEach(doc => {
                    const data = doc.data();
                    const jobId = data.jobId;
                    const completedAt = data.completedAt.toDate();
                    
                    if (!jobCompletions[jobId] || completedAt > jobCompletions[jobId]) {
                        jobCompletions[jobId] = completedAt;
                    }
                });
                
                // Update each job button
                for (let i = 1; i <= 20; i++) {
                    const button = document.getElementById(`job-btn-${i}`);
                    if (!button) continue;
                    
                    const lastCompleted = jobCompletions[i];
                    if (lastCompleted) {
                        const now = new Date();
                        const timeDiff = now - lastCompleted;
                        const eightHours = 8 * 60 * 60 * 1000; // 8 hours in milliseconds
                        
                        if (timeDiff < eightHours) {
                            // Still in cooldown
                            const remainingTime = eightHours - timeDiff;
                            const hours = Math.floor(remainingTime / (60 * 60 * 1000));
                            const minutes = Math.floor((remainingTime % (60 * 60 * 1000)) / (60 * 1000));
                            
                            button.textContent = `${hours}‡¶ò ${minutes}‡¶Æ‡¶ø`;
                            button.className = 'bg-red-600 text-white px-4 py-2 rounded-lg font-medium cursor-not-allowed';
                            button.disabled = true;
                            button.onclick = null;
                        } else {
                            // Cooldown finished, ready again
                            button.textContent = '‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®';
                            button.className = 'bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors';
                            button.disabled = false;
                            const jobLink = button.getAttribute('data-job-link') || '#';
                            button.onclick = () => handleJobClick(i, jobLink);
                        }
                    }
                }
            } catch (error) {
                console.error("Error updating job button states:", error);
            }
        }

        window.handleJobClick = async function(jobId, jobLink) {
            if (!currentUser) return showAlert("‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
            
            const completedJobsRef = collection(db, 'daily_jobs_completed');
            const q = query(completedJobsRef, 
                where('userId', '==', currentUser.uid),
                where('jobId', '==', jobId)
            );
            
            const completedJobs = await getDocs(q);
            let lastCompleted = null;
            
            completedJobs.forEach(doc => {
                const completedAt = doc.data().completedAt.toDate();
                if (!lastCompleted || completedAt > lastCompleted) {
                    lastCompleted = completedAt;
                }
            });
            
            if (lastCompleted) {
                const now = new Date();
                const timeDiff = now - lastCompleted;
                const eightHours = 8 * 60 * 60 * 1000; // 8 hours in milliseconds
                
                if (timeDiff < eightHours) {
                    const remainingTime = eightHours - timeDiff;
                    const hours = Math.floor(remainingTime / (60 * 60 * 1000));
                    const minutes = Math.floor((remainingTime % (60 * 60 * 1000)) / (60 * 1000));
                    return showAlert(`‡¶è‡¶á ‡¶ï‡¶æ‡¶ú‡¶ü‡¶ø ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ü‡¶∞‡ßã ${hours} ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ${minutes} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`);
                }
            }
            
            // If no link set, show message
            if (!jobLink || jobLink === '#') {
                return showAlert("‡¶è‡¶á ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶è‡¶ñ‡¶®‡ßã ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§");
            }
            
            currentJobTracking = {
                jobId: jobId,
                startTime: Date.now(),
                jobLink: jobLink
            };
            
            // Open link in new tab
            window.open(jobLink, '_blank');
            
            // Show instruction message
            showAlert("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡ßß‡ß´ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ ‡¶è‡¶á ‡¶™‡ßá‡¶ú‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ü‡¶∏‡ßÅ‡¶®‡•§");
        };

        async function completeJobAfterValidation(jobId) {
            try {
                await addDoc(collection(db, 'daily_jobs_completed'), {
                    userId: currentUser.uid,
                    userName: userData.name || 'Unknown',
                    jobId: jobId,
                    completedAt: serverTimestamp(),
                    coinsEarned: 5,
                    userAgent: navigator.userAgent
                });
                
                // Update user balance
                const userRef = doc(db, 'users', currentUser.uid);
                await updateDoc(userRef, {
                    balance: increment(5)
                });
                
                userData.balance += 5;
                updateUI();
                showAlert("üéâ ‡¶∏‡¶´‡¶≤! ‡ß≥5 ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶Ø‡ßã‡¶ó ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
                
                updateJobButtonStates();
            } catch (error) {
                console.error("Error completing job:", error);
                showAlert("‡¶ï‡¶æ‡¶ú ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
            }
        }

        // Pro Jobs Functions - Updated with code input system
        async function setupProJobs() {
            const proJobsContainer = document.getElementById('pro-jobs-container');
            if (!proJobsContainer) return;

            let proJobLinks = {};
            try {
                const configRef = doc(db, 'config', 'pro_job_links');
                const configDoc = await getDoc(configRef);
                if (configDoc.exists()) {
                    proJobLinks = configDoc.data();
                }
            } catch (error) {
                console.log("Error fetching pro job links:", error);
            }

            proJobsContainer.innerHTML = '';
            
            for (let i = 1; i <= 5; i++) {
                const jobLink = proJobLinks[`projob${i}`] || '#';
                const jobCode = proJobCodes[`projob${i}`] || 'CODE123';
                
                const jobDiv = document.createElement('div');
                jobDiv.className = 'card-bg p-4 rounded-lg';
                jobDiv.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-purple-600 rounded-full flex items-center justify-center text-white font-bold">${i}</div>
                            <div>
                                <h3 class="text-slate-800 font-medium">‡¶ï‡ßã‡¶° ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                                <p class="text-gray-600 text-sm">‡ß≥8 ‡¶Ü‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                            </div>
                        </div>
                        <button id="pro-job-btn-${i}" onclick="handleProJobClick(${i}, '${jobLink}', '${jobCode}')" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                            ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®
                        </button>
                    </div>
                    <div id="code-input-${i}" class="code-input-container">
                        <input type="text" id="code-input-field-${i}" placeholder="‡¶ï‡ßã‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" class="w-full p-3 rounded-lg input-field mb-2">
                        <button onclick="submitProJobCode(${i}, '${jobCode}')" class="w-full p-3 rounded-lg btn-accent">‡¶ï‡ßã‡¶° ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    </div>
                `;
                proJobsContainer.appendChild(jobDiv);
            }
            
            updateProJobButtonStates();
        }

        async function updateProJobButtonStates() {
            if (!currentUser) return;
            
            const proJobsRef = collection(db, 'pro_jobs_completed');
            const q = query(proJobsRef, where('userId', '==', currentUser.uid));
            
            try {
                const completedProJobs = await getDocs(q);
                const proJobCompletions = {};
                
                completedProJobs.forEach(doc => {
                    const data = doc.data();
                    const jobId = data.jobId;
                    const completedAt = data.completedAt.toDate();
                    
                    if (!proJobCompletions[jobId] || completedAt > proJobCompletions[jobId]) {
                        proJobCompletions[jobId] = completedAt;
                    }
                });
                
                // Update each pro job button
                for (let i = 1; i <= 5; i++) {
                    const button = document.getElementById(`pro-job-btn-${i}`);
                    if (!button) continue;
                    
                    const lastCompleted = proJobCompletions[i];
                    if (lastCompleted) {
                        const now = new Date();
                        const timeDiff = now - lastCompleted;
                        const twentyFourHours = 24 * 60 * 60 * 1000; // 24 hours in milliseconds
                        
                        if (timeDiff < twentyFourHours) {
                            // Still in cooldown
                            const remainingTime = twentyFourHours - timeDiff;
                            const hours = Math.floor(remainingTime / (60 * 60 * 1000));
                            const minutes = Math.floor((remainingTime % (60 * 60 * 1000)) / (60 * 1000));
                            
                            button.textContent = `${hours}‡¶ò ${minutes}‡¶Æ‡¶ø`;
                            button.className = 'bg-red-600 text-white px-4 py-2 rounded-lg font-medium cursor-not-allowed';
                            button.disabled = true;
                            button.onclick = null;
                        } else {
                            // Cooldown finished, ready again
                            button.textContent = '‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®';
                            button.className = 'bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors';
                            button.disabled = false;
                            const jobLink = button.getAttribute('data-job-link') || '#';
                            const jobCode = button.getAttribute('data-job-code') || 'CODE123';
                            button.onclick = () => handleProJobClick(i, jobLink, jobCode);
                        }
                    }
                }
            } catch (error) {
                console.error("Error updating pro job button states:", error);
            }
        }

        window.handleProJobClick = async function(jobId, jobLink, jobCode) {
            if (!currentUser) return showAlert("‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
            
            const completedJobsRef = collection(db, 'pro_jobs_completed');
            const q = query(completedJobsRef, 
                where('userId', '==', currentUser.uid),
                where('jobId', '==', jobId)
            );
            
            const completedJobs = await getDocs(q);
            let lastCompleted = null;
            
            completedJobs.forEach(doc => {
                const completedAt = doc.data().completedAt.toDate();
                if (!lastCompleted || completedAt > lastCompleted) {
                    lastCompleted = completedAt;
                }
            });
            
            if (lastCompleted) {
                const now = new Date();
                const timeDiff = now - lastCompleted;
                const twentyFourHours = 24 * 60 * 60 * 1000; // 24 hours in milliseconds
                
                if (timeDiff < twentyFourHours) {
                    const remainingTime = twentyFourHours - timeDiff;
                    const hours = Math.floor(remainingTime / (60 * 60 * 1000));
                    const minutes = Math.floor((remainingTime % (60 * 60 * 1000)) / (60 * 1000));
                    return showAlert(`‡¶è‡¶á ‡¶ï‡¶æ‡¶ú‡¶ü‡¶ø ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ü‡¶∞‡ßã ${hours} ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ${minutes} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`);
                }
            }
            
            // If no link set, show message
            if (!jobLink || jobLink === '#') {
                return showAlert("‡¶è‡¶á ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶è‡¶ñ‡¶®‡ßã ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§");
            }
            
            // Open link in new tab
            window.open(jobLink, '_blank');
            
            // Show code input field
            document.getElementById(`code-input-${jobId}`).style.display = 'block';
            
            // Show instruction message
            showAlert("‡¶≤‡¶ø‡¶Ç‡¶ï‡ßá ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá ‡¶ï‡ßã‡¶° ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶´‡¶∞‡ßç‡¶Æ‡ßá ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
        };

        window.submitProJobCode = async function(jobId, expectedCode) {
            const userCode = document.getElementById(`code-input-field-${jobId}`).value.trim();
            
            if (!userCode) {
                showAlert("‡¶ï‡ßã‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®");
                return;
            }
            
            if (userCode !== expectedCode) {
                showAlert("‡¶≠‡ßÅ‡¶≤ ‡¶ï‡ßã‡¶°! ‡¶∏‡¶†‡¶ø‡¶ï ‡¶ï‡ßã‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§");
                return;
            }
            
            try {
                await addDoc(collection(db, 'pro_jobs_completed'), {
                    userId: currentUser.uid,
                    userName: userData.name || 'Unknown',
                    jobId: jobId,
                    completedAt: serverTimestamp(),
                    coinsEarned: 8,
                    userAgent: navigator.userAgent
                });
                
                // Update user balance
                const userRef = doc(db, 'users', currentUser.uid);
                await updateDoc(userRef, {
                    balance: increment(8)
                });
                
                userData.balance += 8;
                updateUI();
                showAlert("üéâ ‡¶∏‡¶´‡¶≤! ‡ß≥8 ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶Ø‡ßã‡¶ó ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
                
                // Hide the code input field
                document.getElementById(`code-input-${jobId}`).style.display = 'none';
                
                updateProJobButtonStates();
            } catch (error) {
                console.error("Error completing pro job:", error);
                showAlert("‡¶ï‡¶æ‡¶ú ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
            }
        };

        document.addEventListener('visibilitychange', function() {
            if (!document.hidden && currentJobTracking) {
                // User returned to the page
                const timeSpent = Date.now() - currentJobTracking.startTime;
                const requiredTime = 15 * 1000; // 15 seconds in milliseconds
                
                if (timeSpent >= requiredTime) {
                    // User watched for 15+ seconds - complete the job
                    if (currentJobTracking.jobId <= 20) {
                        completeJobAfterValidation(currentJobTracking.jobId);
                    }
                } else {
                    // User returned too early - show warning
                    const remainingSeconds = Math.ceil((requiredTime - timeSpent) / 1000);
                    showAlert(`‚ö†Ô∏è ‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ: ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ñ‡ßÅ‡¶¨ ‡¶§‡¶æ‡¶°‡¶º‡¶æ‡¶§‡¶æ‡¶°‡¶º‡¶ø ‡¶´‡¶ø‡¶∞‡ßá ‡¶è‡¶∏‡ßá‡¶õ‡ßá‡¶®! ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶∞‡ßã ${remainingSeconds} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`);
                }
                
                // Reset tracking
                currentJobTracking = null;
            }
        });

        function checkAdminAccess() {
            const adminEmails = ['admin@smartmoneypro.com', 'owner@smartmoneypro.com'];
            const adminAccess = document.getElementById('admin-access');
            if (adminEmails.includes(currentUser?.email)) {
                adminAccess.classList.remove('hidden');
            } else {
                adminAccess.classList.add('hidden');
            }
        }

        async function loadAdminDashboard() {
            // Load admin dashboard data
        }

        function showAdminTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.admin-tab-btn').forEach(btn => {
                btn.classList.remove('bg-purple-600', 'text-white');
                btn.classList.add('card-bg', 'text-gray-600');
            });
            
            // Show selected tab content
            document.getElementById(`admin-${tabName}-tab`).classList.remove('hidden');
            
            // Add active class to selected tab button
            document.getElementById(`${tabName}-tab`).classList.remove('card-bg', 'text-gray-600');
            document.getElementById(`${tabName}-tab`).classList.add('bg-purple-600', 'text-white');
        }

        function saveJobSettings() {
            console.log("Saving job settings");
        }

        function resetJobForm() {
            console.log("Resetting job form");
        }

        function toggleUserBlock() {
            console.log("Toggling user block");
        }

        function updateWithdrawalStatus() {
            console.log("Updating withdrawal status");
        }

        function searchUsers() {
            console.log("Searching users");
        }

        function updateCooldownTimers() {
            updateJobButtonStates();
            updateProJobButtonStates();
            // Update every minute
            setInterval(updateJobButtonStates, 60000);
            setInterval(updateProJobButtonStates, 60000);
        }

        // Make admin functions globally accessible
        window.showAdminTab = showAdminTab;
        window.saveJobSettings = saveJobSettings;
        window.resetJobForm = resetJobForm;
        window.toggleUserBlock = toggleUserBlock;
        window.updateWithdrawalStatus = updateWithdrawalStatus;
        window.searchUsers = searchUsers;

        updateCooldownTimers();

        // Toast notification function
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                document.body.removeChild(toast);
            }, 3000);
        }

        window.claimReward = async function(taskType) {
            const today = new Date().toISOString().split('T')[0];
            const userRef = doc(db, "users", currentUser.uid);

            if (userData.lastAdWatchDate !== today) {
                await updateDoc(userRef, { dailyAdCount: 0, lastAdWatchDate: today });
                userData.dailyAdCount = 0;
                userData.lastAdWatchDate = today;
            }

            if (userData.dailyAdCount >= (appConfig.dailyAdLimit || 10)) {
                return showAlert("‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶∂‡ßá‡¶∑ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
            }
            
            if (typeof window.show_9391539 !== 'function') {
                return showAlert("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶è‡¶ñ‡¶® ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶®‡ßá‡¶á‡•§ ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
            }
            
            let adPromise;
            switch(taskType) {
                case 'interstitial':
                    adPromise = window.show_9783879();
                    break;
                case 'popup':
                    adPromise = window.show_9783879('pop');
                    break;
                case 'inApp':
                    adPromise = window.show_9783879({ type: 'inApp', inAppSettings: { frequency: 2, capping: 0.1, interval: 30, timeout: 5, everyPage: false } });
                    break;
                case 'miniApp':
                    adPromise = window.show_9783879();
                    break;
                default:
                    return;
            }

            adPromise.then(async () => {
                const newCount = (userData.dailyAdCount || 0) + 1;
                await updateDoc(userRef, { dailyAdCount: newCount });
                userData.dailyAdCount = newCount;
                
                let rewardAmount = 0;
                if (taskType === 'miniApp') {
                    rewardAmount = 10; // Mini App reward
                } else if (taskType !== 'inApp') {
                    rewardAmount = 5;
                }

                if (rewardAmount > 0) {
                    updateBalance(rewardAmount);
                    showAlert(`‡¶Ö‡¶≠‡¶ø‡¶®‡¶®‡ßç‡¶¶‡¶®! ‡¶Ü‡¶™‡¶®‡¶ø ‡ß≥${rewardAmount} ‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®‡•§`);
                }
                updateAdsLeftCount();
            }).catch(e => {
                console.error("Ad error:", e);
                showAlert('‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶® ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
            });
        };

    </script>
</body>
</html>
